<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 å†°å³¶ 15 å¤©ç’°å³¶ä¹‹æ—…</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        nordic: {
                            light: '#F5F7FA', // é›ªç™½
                            blue: '#4A6FA5',  // å†°å·è—
                            dark: '#2C3E50',  // ç«å±±å²©
                            sand: '#E6E2D3',  // æ²™ç˜
                            accent: '#E76F51', // æ¨™è¨˜ç´…
                            green: '#2A9D8F'  // å®‰å…¨ç¶ 
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; overflow: hidden; }
        
        /* Custom Scrollbar */
        .scroller::-webkit-scrollbar { width: 6px; }
        .scroller::-webkit-scrollbar-track { background: transparent; }
        .scroller::-webkit-scrollbar-thumb { background-color: #CBD5E1; border-radius: 20px; }
        
        /* Map Marker Styles */
        .custom-div-icon {
            background: transparent;
            border: none;
        }
        
        /* New Circle Marker Style */
        .custom-marker-circle {
            width: 36px;
            height: 36px;
            background-color: #4A6FA5; /* Nordic Blue */
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Bouncy effect */
        }
        
        .custom-marker-circle i {
            color: white;
            font-size: 16px;
        }

        /* Active/Hover State */
        .marker-active .custom-marker-circle {
            background-color: #E76F51; /* Accent Color */
            transform: scale(1.25);
            box-shadow: 0 6px 12px rgba(0,0,0,0.4);
            border-color: #fff;
            z-index: 9999;
        }
        
        /* Layout Handling */
        #app-container {
            display: flex;
            height: 100vh;      /* Fallback */
            height: 100dvh;     /* Dynamic Viewport Height for Mobile */
            width: 100vw;
        }
        
        /* Mobile Layout (Default) */
        @media (max-width: 1023px) {
            #app-container { flex-direction: column; }
            #map-container { height: 35vh; height: 35dvh; width: 100%; order: 1; z-index: 50; }
            #list-container { height: 65vh; height: 65dvh; width: 100%; order: 2; }
            .transport-line { height: 40px; border-left: 2px dashed #CBD5E1; margin-left: 1.2rem; }
        }
        
        /* Desktop Layout */
        @media (min-width: 1024px) {
            #app-container { flex-direction: row; }
            #list-container { width: 35%; height: 100vh; height: 100dvh; order: 1; border-right: 1px solid #e2e8f0; }
            #map-container { width: 65%; height: 100vh; height: 100dvh; order: 2; }
            .transport-line { height: 40px; border-left: 2px dashed #CBD5E1; margin-left: 1.2rem; }
        }
    </style>
</head>
<body class="bg-nordic-light text-slate-700">

    <!-- DATA SOURCE: EDIT HERE FOR ITINERARY CHANGES -->
    <script>
        // ---------------------------------------------------------
        // æ ¸å¿ƒè³‡æ–™çµæ§‹ (Travel Data)
        // ---------------------------------------------------------
        const travelData = [
            {
                day: 1,
                date: "6/18",
                title: "æŠµé”èˆ‡åŸºåº•ç‰©è³‡å¤§æ¡è²·",
                summary: "å»ºç«‹è‡ªç…®åŸºç¤ï¼Œç¬¬ä¸€å¤©è²·é½Šé‡ç‰©ã€‚",
                drive: { dist: "50 km", time: "50 min", route: "41 è™Ÿå…¬è·¯" },
                tips: [
                    { type: "car", text: "å–è»Šé‡é»ï¼šå‹™å¿…åŠ è³¼ç¢çŸ³éšª (GP) èˆ‡æ²™ç¤«éšª (SAAP)ã€‚" },
                    { type: "car", text: "æª¢æŸ¥è»Šåº•ç‹€æ³èˆ‡è¼ªèƒï¼Œç¢ºèªå››è¼ªé©…å‹•åŠŸèƒ½æ­£å¸¸ã€‚" },
                    { type: "shopping", text: "Costco/BÃ³nusï¼šæ²¹ã€é¹½ã€é»‘èƒ¡æ¤’ã€ç±³/ç¾©å¤§åˆ©éºµã€å¤§é‡ç“¶è£æ°´ã€å¤§è¢‹æ´‹è”¥/é¦¬éˆ´è–¯ã€åå¸ã€é•·æ•ˆé®®å¥¶ã€‚" },
                    { type: "safety", text: "å¸‚å€å…¨é¢ç¦é£› (No Drone Zone)ã€‚Sky Lagoon ç‚ºç§æœ‰åœ°ç¦é£›ã€‚" }
                ],
                locations: [
                    { name: "KeflavÃ­k Airport", mapName: "KeflavÃ­k International Airport", coords: [63.9868, -22.6280], type: "airport", desc: "07:50 æŠµé”ï¼Œ10:30 å‰å–è»Šå®Œç•¢ã€‚", icon: "fa-plane", droneTag: "forbidden" },
                    { name: "Costco / BÃ³nus", mapName: "Costco Wholesale Iceland", coords: [64.0817, -21.9317], type: "shopping", desc: "ç¬¬ä¸€éšæ®µè£œçµ¦ï¼šåŸºåº•ç‰©è³‡ã€‚", icon: "fa-cart-shopping", droneTag: "forbidden" },
                    { name: "BÃ¦jarins Beztu Pylsur", mapName: "BÃ¦jarins Beztu Pylsur", coords: [64.1484, -21.9366], type: "food", desc: "åˆé¤ï¼šè‘—åçš„ç¾Šè‚‰ç†±ç‹—ã€‚", icon: "fa-hotdog", droneTag: "forbidden" },
                    { name: "Sky Lagoon", mapName: "Sky Lagoon", coords: [64.1147, -21.9547], type: "activity", desc: "ä¸‹åˆæ”¾é¬†æ³¡æ¹¯ï¼Œæ¶ˆé™¤é£›è¡Œç–²å‹ã€‚", icon: "fa-water", droneTag: "forbidden" },
                    { name: "ReykjavÃ­k", mapName: "ReykjavÃ­k", coords: [64.1466, -21.9426], type: "stay", desc: "é¦–åºœä½å®¿ï¼Œæ•´ç†ç‰©è³‡ã€‚æ³¨æ„ Parka App åœè»Šç¹³è²»ã€‚", icon: "fa-bed", droneTag: "forbidden" }
                ]
            },
            {
                day: 2,
                date: "6/19",
                title: "é»ƒé‡‘åœˆèˆ‡åœ°ç†±é¥—å®´",
                summary: "ç¶“å…¸é»ƒé‡‘åœˆè·¯ç·šï¼Œè£œå……ç”Ÿé®®ã€‚",
                drive: { dist: "200 km", time: "3 hr", route: "36 â” 35 â” 37" },
                tips: [
                    { type: "food", text: "FriÃ°heimar ç•ªèŒ„è¾²å ´å‹™å¿…æå‰é ç´„ã€‚" },
                    { type: "drone", text: "è¾›æ ¼éŸ‹å¾·åˆ©åœ‹å®¶å…¬åœ’ (Thingvellir) å…¨é¢ç¦é£›ã€‚" },
                    { type: "drone", text: "Gullfoss é»ƒé‡‘ç€‘å¸ƒæ°´æ°£å¤§ä¸”é¢¨å¼·ï¼Œå»ºè­°è¬¹æ…æˆ–ä¸é£›ã€‚" },
                    { type: "shopping", text: "Selfoss (KrÃ³nan) æ˜¯é€²å…¥å—å²¸å‰æœ€å¾Œå¤§è¶…å¸‚ã€‚" }
                ],
                locations: [
                    { name: "ReykjavÃ­k (Start)", mapName: "ReykjavÃ­k", coords: [64.1466, -21.9426], type: "start", desc: "09:00 å‰å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "forbidden" },
                    { name: "Ãingvellir National Park", mapName: "Thingvellir National Park", coords: [64.2559, -21.1295], type: "sight", desc: "è­°æœƒåœ‹å®¶å…¬åœ’ï¼Œæ¿å¡Šè£‚ç¸«ã€‚", icon: "fa-mountain", droneTag: "forbidden" },
                    { name: "FriÃ°heimar", mapName: "FriÃ°heimar", coords: [64.1776, -20.4468], type: "food", desc: "æº«å®¤ç•ªèŒ„æ¹¯åˆé¤ (é ç´„åˆ¶)ã€‚", icon: "fa-utensils", droneTag: "forbidden" },
                    { name: "Geysir", mapName: "Geysir", coords: [64.3104, -20.3024], type: "sight", desc: "é–“æ­‡æ³‰å™´ç™¼ã€‚", icon: "fa-volcano", droneTag: "allowed" },
                    { name: "Gullfoss", mapName: "Gullfoss Falls", coords: [64.3271, -20.1199], type: "sight", desc: "é»ƒé‡‘ç€‘å¸ƒã€‚", icon: "fa-water", droneTag: "forbidden" },
                    { name: "KeriÃ°", mapName: "Kerid Crater", coords: [64.0413, -20.8851], type: "sight", desc: "ç«å£æ¹–ã€‚", icon: "fa-camera", droneTag: "allowed" },
                    { name: "Selfoss", mapName: "Selfoss", coords: [63.9377, -21.0024], type: "stay", desc: "ä½å®¿ Selfoss æˆ– Hellaã€‚", icon: "fa-bed", droneTag: "allowed" }
                ]
            },
            {
                day: 3,
                date: "6/20",
                title: "F-road I: é«˜åœ°æ©˜è‰²ä¸–ç•Œ",
                summary: "æŒ‘æˆ°å…§é™¸é«˜åœ° KerlingarfjÃ¶llã€‚",
                drive: { dist: "280 km", time: "4.5 hr", route: "35 â” F347" },
                tips: [
                    { type: "drive", text: "è·¯æ³ï¼š35 è™Ÿå…¬è·¯è½‰ F347ã€‚F347 æ¥µé¡›ç°¸ï¼Œéœ€åˆ‡æ› 4WD ä½é€Ÿæª”ã€‚" },
                    { type: "safety", text: "å‡ºç™¼å‰å‹™å¿…åœ¨ SafeTravel.is ç™»éŒ„è¡Œç¨‹ã€‚" },
                    { type: "weather", text: "è‹¥é¢¨é€Ÿ >15m/s çµ•å°ç¦æ­¢é€²å…¥é«˜åœ°ã€‚" },
                    { type: "drone", text: "Hveradalir ç‚ºç©ºæ‹è–åœ°ï¼Œæ©˜è‰²å±±è„ˆèˆ‡ç™½è‰²è’¸æ°£ã€‚" }
                ],
                locations: [
                    { name: "Selfoss/Hella (Start)", mapName: "Hella, Iceland", coords: [63.8346, -20.3986], type: "start", desc: "08:30 å‰å‡ºç™¼ï¼ŒåŠ æ»¿æ²¹ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "Hveradalir", mapName: "Hveradalir Geothermal Area", coords: [64.6433, -19.2737], type: "sight", desc: "æ©˜è‰²åœ°ç†±å€ (ç©ºæ‹è–åœ°)ã€‚", icon: "fa-fire", droneTag: "must" },
                    { name: "Hella / VÃ­k Area", mapName: "Hella, Iceland", coords: [63.8346, -20.3986], type: "stay", desc: "è¿”å›å¹³åœ°ä½å®¿ã€‚", icon: "fa-bed", droneTag: "allowed" }
                ]
            },
            {
                day: 4,
                date: "6/21",
                title: "F-road II: å½©è‰²ç«å±±",
                summary: "Landmannalaugar å½©è‰²ç«å±±èˆ‡é«˜åœ°æ¹–æ³Šã€‚",
                drive: { dist: "230 km", time: "4 hr", route: "26 â” F208 åŒ—æ®µ" },
                tips: [
                    { type: "drive", text: "å‹™å¿…èµ° F208 åŒ—æ®µ (æ­¤æ®µç„¡æ¶‰æ°´)ã€‚åš´ç¦èµ° F208 å—æ®µ (æœ‰æ·±æ°´æ²³æµ)ã€‚" },
                    { type: "safety", text: "é«˜åœ°å®Œå…¨ç„¡æ‰‹æ©Ÿè¨Šè™Ÿï¼Œå‹™å¿…ä¸‹è¼‰é›¢ç·šåœ°åœ–ã€‚" },
                    { type: "car", text: "åœ¨ 26 è™Ÿå…¬è·¯äº¤ç•Œè™•å‹™å¿…åŠ æ»¿æ²¹ã€‚" },
                    { type: "drone", text: "ç©ºæ‹è–åœ°ï¼Œä½†éœ€æ³¨æ„é«˜åœ°é™£é¢¨ï¼Œè‹¥ >10m/s å»ºè­°é™è½ã€‚" }
                ],
                locations: [
                    { name: "Hella (Start)", mapName: "Hella, Iceland", coords: [63.8346, -20.3986], type: "start", desc: "08:30 å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "SigÃ¶ldugljÃºfur", mapName: "SigÃ¶ldugljÃºfur", coords: [64.1568, -19.1360], type: "sight", desc: "æ·šæ°´å³½è°·ï¼Œç„¡æ•¸å°ç€‘å¸ƒã€‚", icon: "fa-water", droneTag: "allowed" },
                    { name: "BlÃ¡hylur", mapName: "BlÃ¡hylur", coords: [64.0373, -19.0435], type: "sight", desc: "çµ•ç¾ç«å£æ¹–ã€‚", icon: "fa-camera", droneTag: "allowed" },
                    { name: "Landmannalaugar", mapName: "Landmannalaugar", coords: [63.9904, -19.0601], type: "sight", desc: "å½©è‰²æµç´‹å²©å±±è„ˆå¥è¡Œã€‚", icon: "fa-mountain", droneTag: "must" },
                    { name: "VÃ­k", mapName: "VÃ­k Ã­ MÃ½rdal", coords: [63.4186, -19.0060], type: "stay", desc: "ä½å®¿ VÃ­k æˆ–å‘¨é‚Šã€‚", icon: "fa-bed", droneTag: "allowed" }
                ]
            },
            {
                day: 5,
                date: "6/22",
                title: "å—å²¸ç¶“å…¸èˆ‡æµ·é¸š",
                summary: "ç¶“å…¸å—å²¸ 1 è™Ÿå…¬è·¯æ™¯é»ã€‚",
                drive: { dist: "160 km", time: "2.5 hr", route: "1 è™Ÿå…¬è·¯" },
                tips: [
                    { type: "safety", text: "é»‘æ²™ç˜ (Reynisfjara) æœ‰è‡´å‘½ç˜‹ç‹—æµªï¼Œçµ•å°ä¸è¦èƒŒå°æµ·æ´‹ï¼Œé é›¢æµ·æ°´ã€‚" },
                    { type: "car", text: "æ­¤å€ç‚ºå¼·é¢¨å€ï¼é–‹è»Šé–€å‹™å¿…é›™æ‰‹æŠ“ç·Šï¼Œé¿å…è»Šé–€è¢«å¹æ–·ã€‚" },
                    { type: "shopping", text: "VÃ­k (KrÃ³nan/OlÃ­s) ç¬¬äºŒéšæ®µè£œçµ¦ï¼šç¾Šæ’ã€é®­é­šã€Skyrã€æ–°é®®è”¬èœã€‚" },
                    { type: "drone", text: "Seljalandsfoss èˆ‡ SkÃ³gafoss éŠå®¢çœ¾å¤šï¼Œé€šå¸¸æœ‰ç¦é£›æ¨™èªŒã€‚" }
                ],
                locations: [
                    { name: "VÃ­k (Start)", mapName: "VÃ­k Ã­ MÃ½rdal", coords: [63.4186, -19.0060], type: "start", desc: "09:30 å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "Seljalandsfoss", mapName: "Seljalandsfoss", coords: [63.6156, -19.9885], type: "sight", desc: "æ°´ç°¾æ´ç€‘å¸ƒã€‚", icon: "fa-water", droneTag: "forbidden" },
                    { name: "SkÃ³gafoss", mapName: "SkÃ³gafoss", coords: [63.5320, -19.5113], type: "sight", desc: "å½©è™¹ç€‘å¸ƒã€‚", icon: "fa-water", droneTag: "forbidden" },
                    { name: "DyrhÃ³laey", mapName: "DyrhÃ³laey Viewpoint", coords: [63.4026, -19.1311], type: "sight", desc: "æµ·è•æ´èˆ‡æµ·é¸š (Puffins)ã€‚", icon: "fa-binoculars", droneTag: "forbidden" },
                    { name: "Reynisfjara Beach", mapName: "Reynisfjara Beach", coords: [63.4057, -19.0716], type: "sight", desc: "é»‘æ²™ç˜èˆ‡ç„æ­¦å²©æŸ±ã€‚", icon: "fa-umbrella-beach", droneTag: "allowed" },
                    { name: "Restaurant SuÃ°ur-VÃ­k", mapName: "SuÃ°ur-VÃ­k", coords: [63.4194, -19.0134], type: "food", desc: "æ™šé¤æ¨è–¦ã€‚", icon: "fa-utensils", droneTag: "forbidden" },
                    { name: "VÃ­k", mapName: "VÃ­k Ã­ MÃ½rdal", coords: [63.4186, -19.0060], type: "stay", desc: "çºŒä½ VÃ­kã€‚", icon: "fa-bed", droneTag: "allowed" }
                ]
            },
            {
                day: 6,
                date: "6/23",
                title: "å†°å·å¥è¡Œæ—¥",
                summary: "æŒ‘æˆ°å†°å³¶æœ€å¤§çš„ç“¦ç‰¹ç´å†°å·ã€‚",
                drive: { dist: "140 km", time: "2 hr", route: "1 è™Ÿå…¬è·¯" },
                tips: [
                    { type: "activity", text: "å†°å·å¥è¡Œé ç´„ä¸­åˆå ´æ¬¡ï¼Œéœ€æå‰ 15-20 åˆ†é˜å ±åˆ°ã€‚" },
                    { type: "gear", text: "è«‹ç©¿è‘—ç¡¬åº•ç™»å±±é‹ï¼Œæ–¹ä¾¿ç©¿è‘—å†°çˆªã€‚" },
                    { type: "drone", text: "å†°å·å¥è¡Œå€åŸŸ (Skaftafell) å±¬æ–¼åœ‹å®¶å…¬åœ’ï¼Œåš´æ ¼ç¦é£›ã€‚" },
                    { type: "drone", text: "ç¾½æ¯›å³½è°· (FjaÃ°rÃ¡rgljÃºfur) åƒ…é™åœè»Šå ´å‘¨é‚Šå€åŸŸèµ·é£›ï¼Œå³½è°·å…§éƒ¨ç¦é£›ã€‚" }
                ],
                locations: [
                    { name: "VÃ­k (Start)", mapName: "VÃ­k Ã­ MÃ½rdal", coords: [63.4186, -19.0060], type: "start", desc: "09:00 å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "FjaÃ°rÃ¡rgljÃºfur", mapName: "FjaÃ°rÃ¡rgljÃºfur", coords: [63.7712, -18.1718], type: "sight", desc: "ç¾½æ¯›å³½è°· (Justin Bieber MV å ´æ™¯)ã€‚", icon: "fa-water", droneTag: "allowed" },
                    { name: "Kjarval KirkjubÃ¦jarklaustur", mapName: "Kjarval KirkjubÃ¦jarklaustur", coords: [63.7924, -18.0515], type: "shopping", desc: "é€”ä¸­è£œçµ¦é» (å°å‹è¶…å¸‚)ã€‚", icon: "fa-cart-shopping" },
                    { name: "Skaftafell", mapName: "Skaftafell", coords: [64.0163, -16.9664], type: "activity", desc: "å†°å·å¥è¡Œé›†åˆé»ã€‚", icon: "fa-person-hiking", droneTag: "forbidden" },
                    { name: "Hof Area", mapName: "Hof, Iceland", coords: [63.9073, -16.7067], type: "stay", desc: "ä½å®¿ Hof (Hofskirkja) æˆ–å†°æ²³æ¹–é™„è¿‘ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 7,
                date: "6/24",
                title: "ç§˜å¢ƒå³½è°·èˆ‡é¾è¦å¤§é¤",
                summary: "é­”æˆ’å³½è°·å¥è¡Œèˆ‡é‘½çŸ³æ²™ç˜ã€‚",
                drive: { dist: "130 km", time: "2 hr", route: "1 è™Ÿå…¬è·¯" },
                tips: [
                    { type: "activity", text: "MÃºlagljÃºfur å¥è¡Œ+ç©ºæ‹éœ€é ç•™ 3-4 å°æ™‚ã€‚" },
                    { type: "food", text: "PakkhÃºs (é¾è¦) ä¸æ¥å—è¨‚ä½ï¼Œå»ºè­°é–‹é–€å‰å»æ’éšŠã€‚" },
                    { type: "drone", text: "JÃ¶kulsÃ¡rlÃ³n å†°æ²³æ¹–å› æœ‰æ°´é™¸å…©æ£²èˆ¹èˆ‡éŠå®¢ï¼Œé€šå¸¸ç¦é£›ã€‚" },
                    { type: "drone", text: "MÃºlagljÃºfur ç‚ºçµ•ä½³ç©ºæ‹é»ï¼Œå¯æ‹å‡ºé›»å½±å ´æ™¯æ„Ÿ ğŸšã€‚" }
                ],
                locations: [
                    { name: "Hof (Start)", mapName: "Hof, Iceland", coords: [63.9073, -16.7067], type: "start", desc: "08:30 å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "MÃºlagljÃºfur Canyon", mapName: "MÃºlagljÃºfur Canyon", coords: [63.9930, -16.4363], type: "sight", desc: "éš±è—ç‰ˆé­”æˆ’å³½è°· (å¿…é£› ğŸš)ã€‚", icon: "fa-mountain", droneTag: "must" },
                    { name: "JÃ¶kulsÃ¡rlÃ³n", mapName: "JÃ¶kulsÃ¡rlÃ³n", coords: [64.0484, -16.1794], type: "sight", desc: "å†°æ²³æ¹–ã€‚", icon: "fa-icicles", droneTag: "forbidden" },
                    { name: "Diamond Beach", mapName: "Diamond Beach", coords: [64.0442, -16.1777], type: "sight", desc: "é‘½çŸ³æ²™ç˜ã€‚", icon: "fa-gem", droneTag: "forbidden" },
                    { name: "PakkhÃºs Restaurant", mapName: "PakkhÃºs Restaurant", coords: [64.2541, -15.2078], type: "food", desc: "æ™šé¤ï¼šé¾è¦å¤§é¤ã€‚", icon: "fa-utensils", droneTag: "forbidden" },
                    { name: "HÃ¶fn", mapName: "HÃ¶fn", coords: [64.2497, -15.2020], type: "stay", desc: "ä½å®¿èµ«æœ¬ (HÃ¶fn)ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 8,
                date: "6/25",
                title: "å¤©ç©ºä¹‹é¡èˆ‡æ±å³½ç£",
                summary: "æ±éƒ¨æµ·å²¸ç·šç§»å‹•æ—¥ã€‚",
                drive: { dist: "250 km", time: "3.5 hr", route: "1 è™Ÿå…¬è·¯" },
                tips: [
                    { type: "drive", text: "æ±éƒ¨éš§é“å¤šç‚ºå–®å‘ï¼Œå‹™å¿…é–‹å¤§ç‡ˆã€‚é‡å–®å‘æ©‹æ™‚ï¼Œçœ‹æ¨™èªŒèª°å…ˆåˆ°èª°è¡Œã€‚" },
                    { type: "shopping", text: "EgilsstaÃ°ir (NettÃ³) ç‚ºæ±éƒ¨æœ€é‡è¦è£œçµ¦é»ï¼Œä¹‹å¾Œé€²å…¥ç±³æ¹–ç‰©åƒ¹è¼ƒé«˜ã€‚" },
                    { type: "drone", text: "Vestrahorn ç‚ºç§æœ‰åœ°ï¼Œéœ€ä»˜è²»é€²å…¥ï¼Œä½†éå¸¸æ­¡è¿ç©ºæ‹ ğŸšã€‚" }
                ],
                locations: [
                    { name: "HÃ¶fn (Start)", mapName: "HÃ¶fn", coords: [64.2497, -15.2020], type: "start", desc: "09:00 å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "Vestrahorn", mapName: "Vestrahorn", coords: [64.2435, -14.9669], type: "sight", desc: "è™è å±±/å¤©ç©ºä¹‹é¡ (ç§æœ‰åœ°)ã€‚", icon: "fa-camera", droneTag: "must" },
                    { name: "EgilsstaÃ°ir", mapName: "EgilsstaÃ°ir", coords: [65.2669, -14.3948], type: "shopping", desc: "ä¸­é€”ä¼‘æ¯ã€è¶…å¸‚è£œçµ¦ã€‚", icon: "fa-cart-shopping", droneTag: "allowed" },
                    { name: "SeyÃ°isfjÃ¶rÃ°ur", mapName: "SeyÃ°isfjÃ¶rÃ°ur", coords: [65.2598, -14.0101], type: "stay", desc: "ç™½æ—¥å¤¢å†’éšªç‹å°é®ã€‚", icon: "fa-bed", droneTag: "allowed" }
                ]
            },
            {
                day: 9,
                date: "6/26",
                title: "ç¢çŸ³å…¬è·¯èˆ‡å¤–æ˜Ÿåœ°è²Œ",
                summary: "ç„æ­¦å²©å³½è°·èˆ‡é­”é¬¼ç€‘å¸ƒã€‚",
                drive: { dist: "200 km", time: "3 hr", route: "1 â” 923 â” 864" },
                tips: [
                    { type: "drive", text: "864 å…¬è·¯ç¢çŸ³æ¥µå¤š (æ´—è¡£æ¿è·¯)ï¼Œéå¸¸å‚·åº•ç›¤ï¼Œå»ºè­°æ™‚é€Ÿ 40km æ¸›éœ‡ã€‚" },
                    { type: "drone", text: "StuÃ°lagil å¯ç©ºæ‹ ğŸšã€‚Dettifoss å±¬æ–¼åœ‹å®¶å…¬åœ’ç¦é£›ã€‚" },
                    { type: "food", text: "ç±³æ¹– VogafjÃ³s Farm Resort æ™šé¤å»ºè­°é ç´„ã€‚" }
                ],
                locations: [
                    { name: "SeyÃ°isfjÃ¶rÃ°ur (Start)", mapName: "SeyÃ°isfjÃ¶rÃ°ur", coords: [65.2598, -14.0101], type: "start", desc: "08:30 å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "NettÃ³ EgilsstaÃ°ir", mapName: "NettÃ³ EgilsstaÃ°ir", coords: [65.2669, -14.3948], type: "shopping", desc: "é›¢é–‹æ±éƒ¨å‰æœ€å¾Œå¤§è¶…å¸‚ã€‚", icon: "fa-cart-shopping" },
                    { name: "StuÃ°lagil Canyon", mapName: "StuÃ°lagil Canyon", coords: [65.1635, -15.3070], type: "sight", desc: "ç„æ­¦å²©æŸ±å³½è°· (èµ°æ±å´)ã€‚", icon: "fa-mountain", droneTag: "allowed" },
                    { name: "Dettifoss", mapName: "Dettifoss", coords: [65.8146, -16.3846], type: "sight", desc: "é­”é¬¼ç€‘å¸ƒ (èµ° 864 æ±å´)ã€‚", icon: "fa-water", droneTag: "forbidden" },
                    { name: "Hverir", mapName: "Hverir", coords: [65.6409, -16.8093], type: "sight", desc: "åœ°ç†±å€ï¼Œç¡«ç£ºå‘³é‡ã€‚", icon: "fa-fire", droneTag: "allowed" },
                    { name: "MÃ½vatn", mapName: "MÃ½vatn", coords: [65.6062, -16.9942], type: "stay", desc: "ä½å®¿ç±³æ¹–å€ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 10,
                date: "6/27",
                title: "è³é¯¨èˆ‡æµ·é‚Šæº«æ³‰",
                summary: "çœ¾ç¥ç€‘å¸ƒã€èƒ¡è–©ç¶­å…‹èˆ‡é˜¿å…‹é›·é‡Œã€‚",
                drive: { dist: "120 km", time: "2 hr", route: "1 â” 82 è™Ÿ" },
                tips: [
                    { type: "activity", text: "HÃºsavÃ­k è³é¯¨èˆ‡ GeoSea æº«æ³‰éœ€æå‰é ç´„ã€‚" },
                    { type: "car", text: "é€²å…¥ Akureyri å‰çš„ VaÃ°laheiÃ°i éš§é“éœ€ä¸Šç¶²ç¹³è²» (Vegid.is)ï¼Œæˆ–ç¹è·¯ 84+83 (å¤šèŠ± 15 åˆ†é˜)ã€‚" },
                    { type: "drone", text: "çœ¾ç¥ç€‘å¸ƒ (GoÃ°afoss) å…è¨±ç©ºæ‹ï¼Œä½†è¦æ³¨æ„éŠå®¢èˆ‡é£›æ¿ºæ°´éœ§ã€‚" }
                ],
                locations: [
                    { name: "MÃ½vatn (Start)", mapName: "MÃ½vatn", coords: [65.6062, -16.9942], type: "start", desc: "08:30 å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "GoÃ°afoss", mapName: "GoÃ°afoss Waterfall", coords: [65.6828, -17.5502], type: "sight", desc: "çœ¾ç¥ç€‘å¸ƒã€‚", icon: "fa-water", droneTag: "allowed" },
                    { name: "HÃºsavÃ­k", mapName: "HÃºsavÃ­k", coords: [66.0449, -17.3389], type: "activity", desc: "æ­æ´²è³é¯¨ä¹‹éƒ½ã€‚", icon: "fa-ship", droneTag: "forbidden" },
                    { name: "GeoSea", mapName: "GeoSea - Geothermal Sea Baths", coords: [66.0522, -17.3618], type: "activity", desc: "ç„¡é‚Šéš›æµ·é‚Šæº«æ³‰ã€‚", icon: "fa-hot-tub-person", droneTag: "forbidden" },
                    { name: "BÃ³nus Akureyri", mapName: "BÃ³nus Akureyri", coords: [65.6961, -18.1028], type: "shopping", desc: "æŠµé”åŒ—éƒ¨ä¹‹éƒ½è£œè²¨ã€‚", icon: "fa-cart-shopping" },
                    { name: "Akureyri", mapName: "Akureyri", coords: [65.6835, -18.0878], type: "stay", desc: "ä½å®¿é˜¿å…‹é›·é‡Œã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 11,
                date: "6/28",
                title: "åŒ—æ–¹å¤§è£œè²¨èˆ‡å·¨äººå³½è°·",
                summary: "è¥¿åŒ—éƒ¨æµ·å²¸ç·šã€‚",
                drive: { dist: "200 km", time: "3 hr", route: "1 â” 711 ç¢çŸ³è·¯" },
                tips: [
                    { type: "shopping", text: "Akureyri (KrÃ³nan/BÃ³nus) ç‚ºç¬¬ä¸‰éšæ®µè£œçµ¦ï¼Œå‹™å¿…åœ¨æ­¤è£œæ»¿æ¥ä¸‹ä¾† 4 å¤©ä»½ç”Ÿé®®ï¼è¥¿åŒ—å€ç„¡å¤§è¶…å¸‚ã€‚" },
                    { type: "drive", text: "711 å…¬è·¯å¤šç¢çŸ³ä¸”ç°å¡µå¤§ï¼Œæœƒè»Šè«‹æ¸›é€Ÿä¿æŒè·é›¢ã€‚" },
                    { type: "drone", text: "KolugljÃºfur ç”±æ©‹å‚ç›´ä¸‹æ‹å¿…å‚™ ğŸšã€‚HvÃ­tserkur çŠ€ç‰›çŸ³é©åˆä½é£›ç’°ç¹ã€‚" }
                ],
                locations: [
                    { name: "Akureyri (Shopping)", mapName: "Akureyri", coords: [65.6835, -18.0878], type: "shopping", desc: "09:00 å‡ºç™¼ï¼Œç¬¬ä¸‰éšæ®µå¤§è£œçµ¦ã€‚", icon: "fa-cart-shopping", droneTag: "forbidden" },
                    { name: "KolugljÃºfur", mapName: "KolugljÃºfur Canyon", coords: [65.3326, -20.5714], type: "sight", desc: "å·¨äººå³½è°·ã€‚", icon: "fa-mountain", droneTag: "must" },
                    { name: "HvÃ­tserkur", mapName: "HvÃ­tserkur", coords: [65.6063, -20.6353], type: "sight", desc: "çŠ€ç‰›çŸ³èˆ‡æµ·è±¹ã€‚", icon: "fa-camera", droneTag: "must" },
                    { name: "Hvammstangi", mapName: "Hvammstangi", coords: [65.3973, -20.9400], type: "stay", desc: "ä½å®¿è¥¿åŒ—å°é®ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 12,
                date: "6/29",
                title: "æ–¯å¥ˆå±±åŠå³¶ï¼šåœ°æ¨™å·¡ç¦®",
                summary: "è·¨æµ·å¤§æ©‹èˆ‡æ•™å ‚å±±ã€‚",
                drive: { dist: "230 km", time: "3 hr", route: "54 â” 56" },
                tips: [
                    { type: "weather", text: "åŠå³¶å´é¢¨æ¥µå¼·ï¼Œç©ºæ‹æ©Ÿèµ·é£›å‰å‹™å¿…ç¢ºèª Vedur é™£é¢¨æ•¸æ“šã€‚" },
                    { type: "drone", text: "KolgrafarfjÃ¶rÃ°ur è·¨æµ·å¤§æ©‹å¹¾ä½•ç·šæ¢å¿…æ‹ ğŸšã€‚" },
                    { type: "drone", text: "æ•™å ‚å±± (Kirkjufell) å»ºè­°æ–¼ç€‘å¸ƒå°é¢èµ·é£›ï¼Œé¿é–‹äººç¾¤ã€‚" }
                ],
                locations: [
                    { name: "Hvammstangi (Start)", mapName: "Hvammstangi", coords: [65.3973, -20.9400], type: "start", desc: "09:30 å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "Samkaup BÃºÃ°ardalur", mapName: "Samkaup BÃºÃ°ardalur", coords: [65.1093, -21.7634], type: "shopping", desc: "é€²å…¥åŠå³¶å‰çš„è£œçµ¦ç«™ã€‚", icon: "fa-cart-shopping" },
                    { name: "KolgrafarfjÃ¶rÃ°ur", mapName: "KolgrafarfjÃ¶rÃ°ur", coords: [64.9663, -23.1362], type: "sight", desc: "åˆ€åŠå½¢ç‹€è·¨æµ·å¤§æ©‹ã€‚", icon: "fa-bridge", droneTag: "must" },
                    { name: "Kirkjufell", mapName: "Kirkjufell", coords: [64.9417, -23.3069], type: "sight", desc: "æ•™å ‚å±± (æ¬ŠåŠ›éŠæˆ²å ´æ™¯)ã€‚", icon: "fa-mountain", droneTag: "must" },
                    { name: "GrundarfjÃ¶rÃ°ur", mapName: "GrundarfjÃ¶rÃ°ur", coords: [64.9242, -23.2608], type: "stay", desc: "ä½å®¿æ•™å ‚å±±è…³ä¸‹ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 13,
                date: "6/30",
                title: "é»‘æ•™å ‚èˆ‡é‡è¿”é¦–éƒ½",
                summary: "åŠå³¶å—å´èˆ‡æµ·åº•éš§é“ã€‚",
                drive: { dist: "200 km", time: "3 hr", route: "54 â” 1 è™Ÿ" },
                tips: [
                    { type: "drive", text: "å›é›·å…‹é›…ç¶­å…‹çš„ HvalfjÃ¶rÃ°ur æµ·åº•éš§é“å…æ”¶è²»ï¼Œä½†é•·ä¸”æ·±ï¼Œæ³¨æ„è»Šé€Ÿé™åˆ¶ã€‚" },
                    { type: "shopping", text: "Borgarnes ç‚ºå¤§å‹ä¸­ç¹¼ç«™ï¼Œæœ‰å¤§è¶…å¸‚èˆ‡å»æ‰€ã€‚" },
                    { type: "drone", text: "é»‘æ•™å ‚ (BÃºÃ°akirkja) é»‘ç™½å°æ¯”å¼·çƒˆï¼Œé©åˆç©ºæ‹ ğŸšã€‚" }
                ],
                locations: [
                    { name: "GrundarfjÃ¶rÃ°ur (Start)", mapName: "GrundarfjÃ¶rÃ°ur", coords: [64.9242, -23.2608], type: "start", desc: "10:00 å‡ºç™¼ã€‚", icon: "fa-car", droneTag: "allowed" },
                    { name: "BÃºÃ°akirkja", mapName: "BÃºÃ°akirkja", coords: [64.8218, -23.3846], type: "sight", desc: "è‘—åçš„é»‘æ•™å ‚ã€‚", icon: "fa-church", droneTag: "allowed" },
                    { name: "Arnarstapi", mapName: "Arnarstapi", coords: [64.7662, -23.6214], type: "sight", desc: "æµ·è•æ´èˆ‡å·¨äººçŸ³åƒã€‚", icon: "fa-water", droneTag: "allowed" },
                    { name: "Borgarnes", mapName: "Borgarnes", coords: [64.5381, -21.9223], type: "shopping", desc: "ä¸­é€”ä¼‘æ¯ã€è¶…å¸‚èˆ‡å»æ‰€ã€‚", icon: "fa-mug-hot" },
                    { name: "ReykjavÃ­k", mapName: "ReykjavÃ­k", coords: [64.1466, -21.9426], type: "stay", desc: "è¿”å›é¦–éƒ½ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 14,
                date: "7/01",
                title: "é›·å…‹é›…ç¶­å…‹æ·±åº¦éŠ",
                summary: "å¸‚å€æ¡è²·ã€æ•´ç†å½±ç‰‡ã€æ…¶åŠŸå¤§é¤ã€‚",
                drive: { dist: "0-20 km", time: "-", route: "å¸‚å€" },
                tips: [
                    { type: "shopping", text: "å¸‚å€è³¼ç‰©ï¼š66Â°Northã€Omnom å·§å…‹åŠ›ã€Harpa éŸ³æ¨‚å»³è²·æ˜Ÿå·´å…‹æ¯ã€‚" },
                    { type: "food", text: "æ…¶åŠŸå®´ï¼šGrillmarkaÃ°urinn (éœ€é ç´„)ã€‚" },
                    { type: "drone", text: "é›·å…‹é›…ç¶­å…‹å¸‚å€åŒ…å« Harpaã€æ•™å ‚çš†ç‚ºç¦é£›å€ ğŸš«ã€‚" }
                ],
                locations: [
                    { name: "Hallgrimskirkja", mapName: "Hallgrimskirkja", coords: [64.1420, -21.9266], type: "sight", desc: "å“ˆçˆ¾æ ¼æ—å§†æ•™å ‚ã€‚", icon: "fa-church", droneTag: "forbidden" },
                    { name: "Regnbogagatan", mapName: "Rainbow Street, Reykjavik", coords: [64.1432, -21.9306], type: "sight", desc: "å½©è™¹è¡—é“ (SkÃ³lavÃ¶rÃ°ustÃ­gur)ã€‚", icon: "fa-camera", droneTag: "forbidden" },
                    { name: "Sun Voyager", mapName: "Sun Voyager", coords: [64.1476, -21.9223], type: "sight", desc: "å¤ªé™½èˆªæµ·è€…ã€‚", icon: "fa-sailboat", droneTag: "forbidden" },
                    { name: "Harpa", mapName: "Harpa Concert Hall and Conference Centre", coords: [64.1504, -21.9326], type: "sight", desc: "éŸ³æ¨‚å»³ (è²·æ˜Ÿå·´å…‹æ¯)ã€‚", icon: "fa-music", droneTag: "forbidden" },
                    { name: "Omnom Chocolate", mapName: "Omnom Chocolate", coords: [64.1444, -21.9566], type: "shopping", desc: "å†°å³¶è‘—åå·§å…‹åŠ›ã€‚", icon: "fa-cookie-bite" },
                    { name: "Perlan", mapName: "Perlan", coords: [64.1293, -21.9189], type: "sight", desc: "çç æ¨“ï¼Œä¿¯ç°å¸‚æ™¯ã€‚", icon: "fa-building", droneTag: "forbidden" },
                    { name: "GrillmarkaÃ°urinn", mapName: "GrillmarkaÃ°urinn", coords: [64.1475, -21.9392], type: "food", desc: "æ…¶åŠŸå¤§é¤ã€‚", icon: "fa-utensils" }
                ]
            },
            {
                day: 15,
                date: "7/02",
                title: "æœ€çµ‚å·¡ç¦®èˆ‡è³¦æ­¸",
                summary: "æ¿å¡Šæ©‹èˆ‡é‚„è»Šã€‚",
                drive: { dist: "50 km", time: "50 min", route: "41 è™Ÿå…¬è·¯" },
                tips: [
                    { type: "safety", text: "14:30 å‰å®Œæˆé‚„è»Šã€‚è¨˜å¾—åŠ æ»¿æ²¹èˆ‡æ´—è»Š (è‹¥ç§Ÿè»Šåˆç´„è¦æ±‚)ã€‚" },
                    { type: "drone", text: "æ¿å¡Šæ©‹ (Bridge Between Continents) åœ°å½¢ç‰¹æ®Šï¼Œå¯ç©ºæ‹ ğŸšã€‚" }
                ],
                locations: [
                    { name: "ReykjavÃ­k (Start)", mapName: "ReykjavÃ­k", coords: [64.1466, -21.9426], type: "start", desc: "å‰å¾€æ©Ÿå ´æ–¹å‘ã€‚", icon: "fa-car", droneTag: "forbidden" },
                    { name: "Bridge Between Continents", mapName: "Bridge Between Continents", coords: [63.8680, -22.6756], type: "sight", desc: "å…©å¤§æ¿å¡Šæ©‹ (å¯ç©ºæ‹ ğŸš)ã€‚", icon: "fa-bridge", droneTag: "allowed" },
                    { name: "KeflavÃ­k Airport", mapName: "KeflavÃ­k International Airport", coords: [63.9868, -22.6280], type: "airport", desc: "17:15 èµ·é£›ã€‚", icon: "fa-plane-departure", droneTag: "forbidden" }
                ]
            }
        ];
    </script>

    <div id="app-container">
        <!-- LIST CONTAINER -->
        <div id="list-container" class="bg-white overflow-y-auto scroller relative">
            
            <!-- Sticky Header -->
            <div class="sticky top-0 z-40 bg-white/95 backdrop-blur-sm border-b border-gray-100 shadow-sm px-4 py-3">
                <h1 class="text-xl font-bold text-nordic-dark">ğŸ‡®ğŸ‡¸ å†°å³¶ 15 å¤©ç’°å³¶</h1>
                <div class="flex space-x-2 overflow-x-auto mt-2 pb-1 no-scrollbar" id="day-nav">
                    <!-- Day buttons injected by JS -->
                </div>
            </div>

            <div id="itinerary-content" class="p-4 pb-20 space-y-12">
                <!-- Content injected by JS -->
            </div>
        </div>

        <!-- MAP CONTAINER -->
        <div id="map-container" class="bg-gray-200">
            <div id="map" class="h-full w-full"></div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        // ---------------------------------------------------------
        // APP LOGIC
        // ---------------------------------------------------------

        // 1. Initialize Map
        const map = L.map('map', {
            zoomControl: false 
        }).setView([64.9631, -19.0208], 6); // Iceland center

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        L.control.zoom({ position: 'bottomright' }).addTo(map);

        let currentLayerGroup = L.layerGroup().addTo(map);
        let activeMarker = null;
        let currentDayIndex = -1; // Track current day to prevent redundant updates

        // 2. Render Functions
        const contentDiv = document.getElementById('itinerary-content');
        const navDiv = document.getElementById('day-nav');

        function renderApp() {
            travelData.forEach((dayData, index) => {
                // A. Render Navigation Buttons
                const navBtn = document.createElement('button');
                navBtn.className = `flex-shrink-0 px-3 py-1 text-sm rounded-full border border-gray-200 hover:bg-nordic-blue hover:text-white transition-colors day-btn`;
                navBtn.textContent = `D${dayData.day}`;
                navBtn.onclick = () => {
                    document.getElementById(`day-${dayData.day}`).scrollIntoView({ behavior: 'smooth' });
                };
                navDiv.appendChild(navBtn);

                // B. Render Itinerary Content
                const daySection = document.createElement('div');
                daySection.id = `day-${dayData.day}`;
                daySection.className = "day-section scroll-mt-28";
                daySection.dataset.index = index; // For Intersection Observer

                // Drive Info Block - Darker for visibility
                let driveInfoHtml = '';
                if (dayData.drive) {
                    driveInfoHtml = `
                        <div class="flex items-center gap-3 text-xs text-slate-700 bg-slate-100 p-2 rounded-lg mb-4 border border-slate-200 font-medium">
                            <div class="flex items-center gap-1">
                                <i class="fa-solid fa-road text-slate-500"></i>
                                <span>${dayData.drive.dist}</span>
                            </div>
                            <div class="w-px h-3 bg-slate-300"></div>
                            <div class="flex items-center gap-1">
                                <i class="fa-regular fa-clock text-slate-500"></i>
                                <span>${dayData.drive.time}</span>
                            </div>
                            <div class="w-px h-3 bg-slate-300"></div>
                            <div class="flex items-center gap-1">
                                <i class="fa-solid fa-signs-post text-slate-500"></i>
                                <span>${dayData.drive.route}</span>
                            </div>
                        </div>
                    `;
                }

                // Header
                let headerHtml = `
                    <div class="mb-4">
                        <span class="inline-block px-2 py-1 bg-nordic-blue text-white text-xs font-bold rounded uppercase tracking-wider mb-1">Day ${dayData.day} Â· ${dayData.date}</span>
                        <h2 class="text-2xl font-bold text-gray-800">${dayData.title}</h2>
                        <p class="text-gray-500 text-sm mt-1 mb-2">${dayData.summary}</p>
                        ${driveInfoHtml}
                    </div>
                `;

                // Tips Section
                let tipsHtml = '';
                if(dayData.tips && dayData.tips.length > 0) {
                    tipsHtml = `<div class="bg-orange-50 border-l-4 border-orange-400 p-3 mb-6 rounded-r-lg text-sm text-orange-800 space-y-2 shadow-sm">`;
                    dayData.tips.forEach(tip => {
                        let icon = tip.type === 'drone' ? 'fa-helicopter' : 
                                   tip.type === 'shopping' ? 'fa-cart-shopping' : 
                                   tip.type === 'food' ? 'fa-utensils' : 
                                   tip.type === 'car' ? 'fa-car-side' : 
                                   tip.type === 'safety' ? 'fa-shield-halved' : 
                                   tip.type === 'weather' ? 'fa-wind' : 'fa-circle-info';
                        tipsHtml += `<div class="flex items-start gap-2"><i class="fa-solid ${icon} mt-1 flex-shrink-0"></i><span>${tip.text}</span></div>`;
                    });
                    tipsHtml += `</div>`;
                }

                // Locations List
                let locationsHtml = '<div class="space-y-0">';
                
                dayData.locations.forEach((loc, locIndex) => {
                    // Transportation Card (if not first item)
                    if (locIndex > 0) {
                        locationsHtml += `
                            <div class="flex items-center transport-line pl-6 opacity-60">
                                <div class="bg-gray-100 px-3 py-1 rounded-full text-xs text-gray-500 flex items-center gap-2">
                                    <i class="fa-solid fa-route"></i> ç§»å‹•
                                </div>
                            </div>
                        `;
                    }

                    // Drone Status Badge - Explicit text based on tag
                    let droneBadge = '';
                    // Only show drone badge if NOT shopping, food, stay, start, or airport
                    const hideDroneInfo = ['shopping', 'food', 'stay', 'start', 'airport'].includes(loc.type);
                    
                    if (!hideDroneInfo && loc.droneTag) {
                        if (loc.droneTag === 'must') {
                            droneBadge = `<span class="ml-auto flex-shrink-0 text-xs text-purple-700 bg-purple-50 px-2 py-0.5 rounded border border-purple-100 font-bold">ğŸšğŸš å¿…æ‹è–åœ°</span>`;
                        } else if (loc.droneTag === 'allowed') {
                            droneBadge = `<span class="ml-auto flex-shrink-0 text-xs text-green-700 bg-green-50 px-2 py-0.5 rounded border border-green-100">ğŸš é©åˆä¸”ç›®å‰é–‹æ”¾</span>`;
                        } else if (loc.droneTag === 'forbidden') {
                            droneBadge = `<span class="ml-auto flex-shrink-0 text-xs text-red-600 bg-red-50 px-2 py-0.5 rounded border border-red-100">ğŸš« çµ•å°ç¦é£›</span>`;
                        } else if (loc.droneTag === 'caution') { // Fallback if any remain
                            droneBadge = `<span class="ml-auto flex-shrink-0 text-xs text-orange-600 bg-orange-50 px-2 py-0.5 rounded border border-orange-100">âš ï¸ è¬¹æ…é£›è¡Œ</span>`;
                        }
                    }

                    // Location Card
                    locationsHtml += `
                        <div class="location-card relative group bg-white border border-gray-100 hover:border-nordic-blue/50 rounded-xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer"
                             data-lat="${loc.coords[0]}" data-lng="${loc.coords[1]}" data-day="${index}">
                            <div class="flex items-start gap-4">
                                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-nordic-light flex items-center justify-center text-nordic-blue group-hover:bg-nordic-blue group-hover:text-white transition-colors">
                                    <i class="fa-solid ${loc.icon}"></i>
                                </div>
                                <div class="flex-grow min-w-0">
                                    <div class="flex justify-between items-start gap-2">
                                        <h3 class="font-bold text-gray-800 truncate">${loc.name}</h3>
                                        ${droneBadge}
                                    </div>
                                    <p class="text-sm text-gray-500 mt-1">${loc.desc}</p>
                                    <div class="mt-3 flex flex-wrap gap-2">
                                        <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(loc.mapName)}" target="_blank" 
                                           class="inline-flex items-center gap-1 text-xs text-nordic-blue hover:underline bg-blue-50 px-2 py-1 rounded"
                                           onclick="event.stopPropagation()">
                                            <i class="fa-brands fa-google"></i> View on Map
                                        </a>
                                        ${loc.type === 'shopping' ? '<span class="inline-flex items-center gap-1 text-xs text-green-600 bg-green-50 px-2 py-1 rounded">è£œçµ¦ç«™</span>' : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                locationsHtml += '</div>';

                daySection.innerHTML = headerHtml + tipsHtml + locationsHtml;
                contentDiv.appendChild(daySection);
            });
        }

        renderApp();

        // 3. Map Update Logic
        function updateMap(dayIndex) {
            // Prevent redundant updates
            if (currentDayIndex === dayIndex) return;
            currentDayIndex = dayIndex;

            currentLayerGroup.clearLayers();
            const data = travelData[dayIndex];
            const latlngs = [];

            data.locations.forEach((loc, i) => {
                // Custom Marker: Circle with Icon (Updated Style)
                const iconHtml = `
                    <div class="custom-marker-circle">
                        <i class="fa-solid ${loc.icon}"></i>
                    </div>
                `;
                
                const icon = L.divIcon({
                    className: 'custom-div-icon', // Keep base class
                    html: iconHtml,
                    iconSize: [36, 36],    // Width, Height matches CSS
                    iconAnchor: [18, 18]   // Center point (half of size) to be accurate on coords
                });

                const marker = L.marker(loc.coords, { icon: icon }).addTo(currentLayerGroup);
                marker.bindPopup(`<b>${loc.name}</b><br>${loc.desc}`);
                
                // Link marker to DOM element for hover effect
                marker._id = `${dayIndex}-${i}`;
                latlngs.push(loc.coords);
            });

            // Draw Route
            if (latlngs.length > 1) {
                L.polyline(latlngs, { color: '#4A6FA5', weight: 4, opacity: 0.7, dashArray: '10, 10' }).addTo(currentLayerGroup);
            }

            // Fly to bounds
            if (latlngs.length > 0) {
                const bounds = L.latLngBounds(latlngs);
                map.flyToBounds(bounds, { padding: [50, 50], maxZoom: 13, duration: 1.5 });
            }

            // Update Nav Button State
            document.querySelectorAll('.day-btn').forEach((btn, idx) => {
                if (idx === parseInt(dayIndex)) {
                    btn.classList.add('bg-nordic-dark', 'text-white', 'border-nordic-dark');
                } else {
                    btn.classList.remove('bg-nordic-dark', 'text-white', 'border-nordic-dark');
                }
            });
        }

        // 4. Interactions
        
        // A. Intersection Observer for Scroll (Revised for Mobile)
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const dayIndex = entry.target.dataset.index;
                    updateMap(dayIndex);
                }
            });
        }, {
            root: document.getElementById('list-container'),
            rootMargin: '-10% 0px -70% 0px', // Focus on top area of viewport
            threshold: 0 // Trigger as soon as one pixel enters the margin
        });

        document.querySelectorAll('.day-section').forEach(section => {
            observer.observe(section);
        });

        // B. Hover/Click on List Items
        document.querySelectorAll('.location-card').forEach(card => {
            const handleInteract = () => {
                const lat = parseFloat(card.dataset.lat);
                const lng = parseFloat(card.dataset.lng);
                
                // Highlight marker on map
                currentLayerGroup.eachLayer(layer => {
                    const elem = layer.getElement();
                    if (elem) {
                        const mLat = layer.getLatLng().lat;
                        const mLng = layer.getLatLng().lng;
                        
                        // Compare floats with epsilon
                        if (Math.abs(mLat - lat) < 0.0001 && Math.abs(mLng - lng) < 0.0001) {
                            elem.classList.add('marker-active');
                            layer.setZIndexOffset(1000); // Bring to front
                        } else {
                            elem.classList.remove('marker-active');
                            layer.setZIndexOffset(0);
                        }
                    }
                });
            };

            card.addEventListener('mouseenter', handleInteract);
            card.addEventListener('click', () => {
                handleInteract();
                map.flyTo([card.dataset.lat, card.dataset.lng], 14); // Zoom to location
            });
        });

        // Initial Load
        updateMap(0);

    </script>
</body>
</html>
