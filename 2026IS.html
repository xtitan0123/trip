<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2026 å†°å³¶ 15 å¤©ç’°å³¶ä¹‹æ—…</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        nordic: {
                            light: '#F5F7FA', // é›ªç™½
                            blue: '#4A6FA5',  // å†°å·è—
                            dark: '#2C3E50',  // ç«å±±å²©
                            sand: '#E6E2D3',  // æ²™ç˜
                            accent: '#E76F51' // æ¨™è¨˜ç´…
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; overflow: hidden; }
        
        /* Custom Scrollbar */
        .scroller::-webkit-scrollbar { width: 6px; }
        .scroller::-webkit-scrollbar-track { background: transparent; }
        .scroller::-webkit-scrollbar-thumb { background-color: #CBD5E1; border-radius: 20px; }
        
        /* Map Marker Styles */
        .custom-div-icon {
            background: transparent;
            border: none;
        }
        
        /* New Circle Marker Style */
        .custom-marker-circle {
            width: 36px;
            height: 36px;
            background-color: #4A6FA5; /* Nordic Blue */
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Bouncy effect */
        }
        
        .custom-marker-circle i {
            color: white;
            font-size: 16px;
        }

        /* Active/Hover State */
        .marker-active .custom-marker-circle {
            background-color: #E76F51; /* Accent Color */
            transform: scale(1.25);
            box-shadow: 0 6px 12px rgba(0,0,0,0.4);
            border-color: #fff;
        }
        
        /* Layout Handling */
        #app-container {
            display: flex;
            height: 100vh;      /* Fallback */
            height: 100dvh;     /* Dynamic Viewport Height for Mobile */
            width: 100vw;
        }
        
        /* Mobile Layout (Default) */
        @media (max-width: 1023px) {
            #app-container { flex-direction: column; }
            #map-container { height: 35vh; height: 35dvh; width: 100%; order: 1; z-index: 50; }
            #list-container { height: 65vh; height: 65dvh; width: 100%; order: 2; }
            .transport-line { height: 40px; border-left: 2px dashed #CBD5E1; margin-left: 1.2rem; }
        }
        
        /* Desktop Layout */
        @media (min-width: 1024px) {
            #app-container { flex-direction: row; }
            #list-container { width: 35%; height: 100vh; height: 100dvh; order: 1; border-right: 1px solid #e2e8f0; }
            #map-container { width: 65%; height: 100vh; height: 100dvh; order: 2; }
            .transport-line { height: 40px; border-left: 2px dashed #CBD5E1; margin-left: 1.2rem; }
        }
    </style>
</head>
<body class="bg-nordic-light text-slate-700">

    <!-- DATA SOURCE: EDIT HERE FOR ITINERARY CHANGES -->
    <script>
        // ---------------------------------------------------------
        // æ ¸å¿ƒè³‡æ–™çµæ§‹ (Travel Data)
        // ---------------------------------------------------------
        const travelData = [
            {
                day: 1,
                date: "6/18",
                title: "æŠµé”èˆ‡åŸºåº•ç‰©è³‡å¤§æ¡è²·",
                summary: "å»ºç«‹è‡ªç…®åŸºç¤ï¼Œç¬¬ä¸€å¤©è²·é½Šé‡ç‰©ã€‚",
                start: { name: "å°ç£", coords: null }, // Day 1 ç‰¹ä¾‹
                end: { name: "ReykjavÃ­k", coords: [64.1466, -21.9426] },
                tips: [
                    { type: "shopping", text: "Costco/BÃ³nus å¿…è²·ï¼šæ²¹ã€é¹½ã€æ°´ã€ç±³ã€æ´‹è”¥ã€é¦¬éˆ´è–¯ã€‚" },
                    { type: "drone", text: "å¸‚å€å…¨é¢ç¦é£› (No Drone Zone)ã€‚" }
                ],
                locations: [
                    { name: "KeflavÃ­k International Airport", mapName: "KeflavÃ­k International Airport", coords: [63.9868, -22.6280], type: "airport", desc: "07:50 æŠµé”ï¼Œå–è»Šã€‚", icon: "fa-plane" },
                    { name: "Costco / BÃ³nus", mapName: "Costco Wholesale Iceland", coords: [64.0817, -21.9317], type: "shopping", desc: "ç¬¬ä¸€éšæ®µè£œçµ¦ï¼šåŸºåº•ç‰©è³‡ã€‚", icon: "fa-cart-shopping" },
                    { name: "Sky Lagoon", mapName: "Sky Lagoon", coords: [64.1147, -21.9547], type: "activity", desc: "ä¸‹åˆæ”¾é¬†æ³¡æ¹¯ï¼Œæ¶ˆé™¤é£›è¡Œç–²å‹ã€‚", icon: "fa-water" },
                    { name: "ReykjavÃ­k Accommodation", mapName: "ReykjavÃ­k", coords: [64.1466, -21.9426], type: "stay", desc: "é¦–åºœä½å®¿ï¼Œæ•´ç†ç‰©è³‡ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 2,
                date: "6/19",
                title: "é»ƒé‡‘åœˆèˆ‡ç”Ÿé®®åˆè£œ",
                summary: "ç¶“å…¸é»ƒé‡‘åœˆè·¯ç·šï¼Œè£œå……ç”Ÿé®®ã€‚",
                tips: [
                    { type: "food", text: "FriÃ°heimar ç•ªèŒ„è¾²å ´éœ€æå‰é ç´„ã€‚" },
                    { type: "shopping", text: "Selfoss (KrÃ³nan) æ˜¯é€²å…¥å—å²¸å‰æœ€å¾Œå¤§è¶…å¸‚ã€‚" }
                ],
                locations: [
                    { name: "ReykjavÃ­k (Start)", mapName: "ReykjavÃ­k", coords: [64.1466, -21.9426], type: "start", desc: "æ—©æ™¨å‡ºç™¼", icon: "fa-car" },
                    { name: "Ãingvellir National Park", mapName: "Thingvellir National Park", coords: [64.2559, -21.1295], type: "sight", desc: "è­°æœƒåœ‹å®¶å…¬åœ’ï¼Œæ¿å¡Šè£‚ç¸«ã€‚", icon: "fa-mountain" },
                    { name: "FriÃ°heimar", mapName: "FriÃ°heimar", coords: [64.1776, -20.4468], type: "food", desc: "æº«å®¤ç•ªèŒ„æ¹¯åˆé¤ã€‚", icon: "fa-utensils" },
                    { name: "Geysir", mapName: "Geysir", coords: [64.3104, -20.3024], type: "sight", desc: "é–“æ­‡æ³‰å™´ç™¼ã€‚", icon: "fa-volcano" },
                    { name: "Gullfoss", mapName: "Gullfoss Falls", coords: [64.3271, -20.1199], type: "sight", desc: "é»ƒé‡‘ç€‘å¸ƒã€‚", icon: "fa-water" },
                    { name: "KeriÃ°", mapName: "Kerid Crater", coords: [64.0413, -20.8851], type: "sight", desc: "ç«å£æ¹– (å¯ç©ºæ‹ ğŸš)ã€‚", icon: "fa-camera" },
                    { name: "Selfoss (KrÃ³nan)", mapName: "KrÃ³nan Selfoss", coords: [63.9377, -21.0024], type: "shopping", desc: "ç”Ÿé®®è£œçµ¦é»ã€‚", icon: "fa-cart-shopping" },
                    { name: "Selfoss / Hella Accommodation", mapName: "Hella, Iceland", coords: [63.8346, -20.3986], type: "stay", desc: "ä½å®¿ (Hella å‘¨é‚Š)ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 3,
                date: "6/20",
                title: "F-road I: é«˜åœ°æ©˜è‰²åœ°ç†±",
                summary: "æŒ‘æˆ°å…§é™¸é«˜åœ° KerlingarfjÃ¶llã€‚",
                tips: [
                    { type: "drive", text: "è·¯æ³æ¥µé¡›ç°¸ (35 -> F347)ï¼Œè«‹å°ˆæ³¨é§•é§›ã€‚" },
                    { type: "drone", text: "Hveradalir ç‚ºç©ºæ‹è–åœ° ğŸšğŸšã€‚" }
                ],
                locations: [
                    { name: "Hella (Start)", mapName: "Hella, Iceland", coords: [63.8346, -20.3986], type: "start", desc: "å‰å¾€ä¸­å¤®é«˜åœ°", icon: "fa-car" },
                    { name: "KerlingarfjÃ¶ll / Hveradalir", mapName: "Hveradalir Geothermal Area", coords: [64.6433, -19.2737], type: "sight", desc: "é«˜åœ°åœ°ç†±å€ï¼Œå¦‚ç«æ˜Ÿèˆ¬çš„æ©˜è‰²åœ°è²Œã€‚", icon: "fa-fire" },
                    { name: "Hella / VÃ­k Area", mapName: "Hella, Iceland", coords: [63.8346, -20.3986], type: "stay", desc: "è¿”å›å¹³åœ°ä½å®¿ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 4,
                date: "6/21",
                title: "F-road II: å½©è‰²ç«å±±",
                summary: "Landmannalaugar å½©è‰²ç«å±±èˆ‡é«˜åœ°æ¹–æ³Šã€‚",
                tips: [
                    { type: "drive", text: "èµ° F208 åŒ—æ®µå¯é¿é–‹å±éšªéæ²³è·¯æ®µã€‚" },
                    { type: "drone", text: "çµ•å°å¿…é£›çš„æ™¯è‰² ğŸšğŸšã€‚" }
                ],
                locations: [
                    { name: "Hella (Start)", mapName: "Hella, Iceland", coords: [63.8346, -20.3986], type: "start", desc: "å†æ¬¡é€²å…¥é«˜åœ°", icon: "fa-car" },
                    { name: "SigÃ¶ldugljÃºfur", mapName: "SigÃ¶ldugljÃºfur", coords: [64.1568, -19.1360], type: "sight", desc: "æ·šæ°´å³½è°·ï¼Œç„¡æ•¸å°ç€‘å¸ƒã€‚", icon: "fa-water" },
                    { name: "BlÃ¡hylur", mapName: "BlÃ¡hylur", coords: [64.0373, -19.0435], type: "sight", desc: "çµ•ç¾ç«å£æ¹–ã€‚", icon: "fa-camera" },
                    { name: "Landmannalaugar", mapName: "Landmannalaugar", coords: [63.9904, -19.0601], type: "sight", desc: "å½©è‰²æµç´‹å²©å±±è„ˆå¥è¡Œã€‚", icon: "fa-mountain" },
                    { name: "VÃ­k Accommodation", mapName: "VÃ­k Ã­ MÃ½rdal", coords: [63.4186, -19.0060], type: "stay", desc: "å‰å¾€ç¶­å…‹é®ä½å®¿ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 5,
                date: "6/22",
                title: "å—å²¸ç€‘å¸ƒèˆ‡æµ·é¸š",
                summary: "ç¶“å…¸å—å²¸ 1 è™Ÿå…¬è·¯æ™¯é»ã€‚",
                tips: [
                    { type: "shopping", text: "VÃ­k (KrÃ³nan) è£œçµ¦ï¼šç¾Šæ’ã€é®­é­šã€Skyrã€‚" },
                    { type: "safety", text: "é»‘æ²™ç˜é¢¨æµªæ¥µå¤§ï¼Œæ³¨æ„ç˜‹ç‹—æµªï¼Œç©ºæ‹æ³¨æ„å¼·é¢¨ã€‚" }
                ],
                locations: [
                    { name: "VÃ­k (Start)", mapName: "VÃ­k Ã­ MÃ½rdal", coords: [63.4186, -19.0060], type: "start", desc: "ä¸Šåˆè¡Œç¨‹", icon: "fa-car" },
                    { name: "Seljalandsfoss", mapName: "Seljalandsfoss", coords: [63.6156, -19.9885], type: "sight", desc: "æ°´ç°¾æ´ç€‘å¸ƒ (ç¦é£›)ã€‚", icon: "fa-water" },
                    { name: "SkÃ³gafoss", mapName: "SkÃ³gafoss", coords: [63.5320, -19.5113], type: "sight", desc: "å½©è™¹ç€‘å¸ƒ (ç¦é£›)ã€‚", icon: "fa-water" },
                    { name: "DyrhÃ³laey", mapName: "DyrhÃ³laey Viewpoint", coords: [63.4026, -19.1311], type: "sight", desc: "æµ·è•æ´èˆ‡æµ·é¸š (Puffins)ã€‚", icon: "fa-binoculars" },
                    { name: "Reynisfjara Beach", mapName: "Reynisfjara Beach", coords: [63.4057, -19.0716], type: "sight", desc: "é»‘æ²™ç˜èˆ‡ç„æ­¦å²©æŸ±ã€‚", icon: "fa-umbrella-beach" },
                    { name: "Restaurant SuÃ°ur-VÃ­k", mapName: "SuÃ°ur-VÃ­k", coords: [63.4194, -19.0134], type: "food", desc: "æ™šé¤æ¨è–¦ã€‚", icon: "fa-utensils" },
                    { name: "VÃ­k Accommodation", mapName: "VÃ­k Ã­ MÃ½rdal", coords: [63.4186, -19.0060], type: "stay", desc: "çºŒä½ç¶­å…‹ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 6,
                date: "6/23",
                title: "å†°å·å¥è¡Œæ—¥",
                summary: "æŒ‘æˆ°å†°å³¶æœ€å¤§çš„ç“¦ç‰¹ç´å†°å·ã€‚",
                tips: [
                    { type: "gear", text: "è«‹ç©¿è‘—ç¡¬åº•ç™»å±±é‹ï¼Œæ–¹ä¾¿ç©¿å†°çˆªã€‚" }
                ],
                locations: [
                    { name: "VÃ­k (Start)", mapName: "VÃ­k Ã­ MÃ½rdal", coords: [63.4186, -19.0060], type: "start", desc: "å‰å¾€å†°å·å€", icon: "fa-car" },
                    { name: "FjaÃ°rÃ¡rgljÃºfur", mapName: "FjaÃ°rÃ¡rgljÃºfur", coords: [63.7712, -18.1718], type: "sight", desc: "ç¾½æ¯›å³½è°· (Justin Bieber MV å ´æ™¯)ã€‚", icon: "fa-water" },
                    { name: "Skaftafell", mapName: "Skaftafell", coords: [64.0163, -16.9664], type: "activity", desc: "å†°å·å¥è¡Œé›†åˆé»ã€‚", icon: "fa-person-hiking" },
                    { name: "Hof / JÃ¶kulsÃ¡rlÃ³n Area", mapName: "Hof, Iceland", coords: [63.9073, -16.7067], type: "stay", desc: "ä½å®¿ Hof æˆ–å†°æ²³æ¹–é™„è¿‘ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 7,
                date: "6/24",
                title: "ç§˜å¢ƒå³½è°·èˆ‡å†°æ²³æ¹–",
                summary: "æ¢ç´¢ç§˜å¢ƒèˆ‡é‘½çŸ³æ²™ç˜ã€‚",
                tips: [
                    { type: "food", text: "æ™šé¤ï¼šPakkhÃºs Restaurant (HÃ¶fn é¾è¦)ã€‚" },
                    { type: "drone", text: "MÃºlagljÃºfur ç‚ºçµ•ä½³ç©ºæ‹é» ğŸšã€‚" }
                ],
                locations: [
                    { name: "Hof (Start)", mapName: "Hof, Iceland", coords: [63.9073, -16.7067], type: "start", desc: "å‰å¾€ç§˜å¢ƒ", icon: "fa-car" },
                    { name: "MÃºlagljÃºfur Canyon", mapName: "MÃºlagljÃºfur Canyon", coords: [63.9930, -16.4363], type: "sight", desc: "éš±è—ç‰ˆå³½è°·å¥è¡Œ (3h)ã€‚", icon: "fa-mountain" },
                    { name: "JÃ¶kulsÃ¡rlÃ³n", mapName: "JÃ¶kulsÃ¡rlÃ³n", coords: [64.0484, -16.1794], type: "sight", desc: "å‚‘å¤æ²™é¾å†°æ²³æ¹–ã€‚", icon: "fa-icicles" },
                    { name: "Diamond Beach", mapName: "Diamond Beach", coords: [64.0442, -16.1777], type: "sight", desc: "é‘½çŸ³æ²™ç˜ã€‚", icon: "fa-gem" },
                    { name: "HÃ¶fn (Netto)", mapName: "NettÃ³ HÃ¶fn", coords: [64.2541, -15.2078], type: "shopping", desc: "æµ·é®®è£œçµ¦ã€‚", icon: "fa-cart-shopping" },
                    { name: "HÃ¶fn Accommodation", mapName: "HÃ¶fn", coords: [64.2497, -15.2020], type: "stay", desc: "ä½å®¿é¾è¦å°é®ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 8,
                date: "6/25",
                title: "å¤©ç©ºä¹‹é¡èˆ‡å³½ç£å…¬è·¯",
                summary: "æ±éƒ¨æµ·å²¸ç·šç§»å‹•æ—¥ã€‚",
                tips: [
                    { type: "shopping", text: "EgilsstaÃ°ir (NettÃ³) ç‚ºæ±éƒ¨æœ€é‡è¦è£œçµ¦é»ã€‚" }
                ],
                locations: [
                    { name: "HÃ¶fn (Start)", mapName: "HÃ¶fn", coords: [64.2497, -15.2020], type: "start", desc: "å‰å¾€æ±éƒ¨", icon: "fa-car" },
                    { name: "Vestrahorn", mapName: "Vestrahorn", coords: [64.2435, -14.9669], type: "sight", desc: "è™è å±±/å¤©ç©ºä¹‹é¡ (ç§æœ‰åœ°éœ€ä»˜è²»)ã€‚", icon: "fa-camera" },
                    { name: "EgilsstaÃ°ir", mapName: "EgilsstaÃ°ir", coords: [65.2669, -14.3948], type: "shopping", desc: "ä¸­é€”ä¼‘æ¯ã€è¶…å¸‚è£œçµ¦ã€‚", icon: "fa-cart-shopping" },
                    { name: "SeyÃ°isfjÃ¶rÃ°ur", mapName: "SeyÃ°isfjÃ¶rÃ°ur", coords: [65.2598, -14.0101], type: "stay", desc: "ç™½æ—¥å¤¢å†’éšªç‹æ»‘æ¿è·¯å°é®ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 9,
                date: "6/26",
                title: "å¹¾ä½•å³½è°·èˆ‡å¤–æ˜Ÿåœ°è²Œ",
                summary: "å£¯è§€çš„ç„æ­¦å²©å³½è°·èˆ‡åœ°ç†±å€ã€‚",
                tips: [
                    { type: "drive", text: "864 å…¬è·¯è·¯æ³å·®æ¥µå‚·åº•ç›¤ï¼Œè«‹æ…¢è¡Œã€‚" },
                    { type: "drone", text: "StuÃ°lagil å¯ç©ºæ‹ ğŸšã€‚" }
                ],
                locations: [
                    { name: "SeyÃ°isfjÃ¶rÃ°ur (Start)", mapName: "SeyÃ°isfjÃ¶rÃ°ur", coords: [65.2598, -14.0101], type: "start", desc: "å‰å¾€ç±³æ¹–å€", icon: "fa-car" },
                    { name: "StuÃ°lagil Canyon", mapName: "StuÃ°lagil Canyon", coords: [65.1635, -15.3070], type: "sight", desc: "ç„æ­¦å²©æŸ±å³½è°· (èµ°æ±å´)ã€‚", icon: "fa-mountain" },
                    { name: "Dettifoss", mapName: "Dettifoss", coords: [65.8146, -16.3846], type: "sight", desc: "é­”é¬¼ç€‘å¸ƒ (æ­æ´²æ°´é‡æœ€å¤§)ã€‚", icon: "fa-water" },
                    { name: "Hverir", mapName: "Hverir", coords: [65.6409, -16.8093], type: "sight", desc: "åœ°ç†±å€ï¼Œç¡«ç£ºå‘³é‡ã€‚", icon: "fa-fire" },
                    { name: "MÃ½vatn Accommodation", mapName: "MÃ½vatn", coords: [65.6062, -16.9942], type: "stay", desc: "ä½å®¿ç±³æ¹–å€ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 10,
                date: "6/27",
                title: "çœ¾ç¥ç€‘å¸ƒèˆ‡å•¤é…’æ…¶å…¸",
                summary: "ç±³æ¹–å‘¨é‚Šèˆ‡ç‰¹è‰²å•¤é…’æº«æ³‰ã€‚",
                tips: [
                    { type: "activity", text: "BjÃ³rbÃ¶Ã°in å•¤é…’æº«æ³‰å¾ˆç‰¹åˆ¥ã€‚" }
                ],
                locations: [
                    { name: "MÃ½vatn (Start)", mapName: "MÃ½vatn", coords: [65.6062, -16.9942], type: "start", desc: "å‰å¾€åŒ—æ–¹ä¹‹éƒ½", icon: "fa-car" },
                    { name: "GoÃ°afoss", mapName: "GoÃ°afoss Waterfall", coords: [65.6828, -17.5502], type: "sight", desc: "çœ¾ç¥ç€‘å¸ƒã€‚", icon: "fa-water" },
                    { name: "BjÃ³rbÃ¶Ã°in", mapName: "BjÃ³rbÃ¶Ã°in - The Beer Spa", coords: [65.9525, -18.5273], type: "activity", desc: "å•¤é…’ SPAã€‚", icon: "fa-hot-tub-person" },
                    { name: "Akureyri Accommodation", mapName: "Akureyri", coords: [65.6835, -18.0878], type: "stay", desc: "ä½å®¿åŒ—æ–¹ä¹‹éƒ½ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 11,
                date: "6/28",
                title: "åŒ—æ–¹å¤§è£œè²¨èˆ‡æµ·ä¸ŠçŠ€ç‰›",
                summary: "è¥¿åŒ—éƒ¨æµ·å²¸ç·šã€‚",
                tips: [
                    { type: "shopping", text: "Akureyri (KrÃ³nan/BÃ³nus) å‹™å¿…è£œæ»¿ 4 å¤©ä»½ç”Ÿé®®ï¼" },
                    { type: "drone", text: "çŠ€ç‰›çŸ³é©åˆç©ºæ‹ ğŸšã€‚" }
                ],
                locations: [
                    { name: "Akureyri (Shopping)", mapName: "Akureyri", coords: [65.6835, -18.0878], type: "shopping", desc: "ç¬¬ä¸‰éšæ®µå¤§è£œçµ¦ã€‚", icon: "fa-cart-shopping" },
                    { name: "HvÃ­tserkur", mapName: "HvÃ­tserkur", coords: [65.6063, -20.6353], type: "sight", desc: "çŠ€ç‰›çŸ³èˆ‡æµ·è±¹ã€‚", icon: "fa-camera" },
                    { name: "Hvammstangi Area", mapName: "Hvammstangi", coords: [65.3973, -20.9400], type: "stay", desc: "ä½å®¿è¥¿åŒ—å°é®ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 12,
                date: "6/29",
                title: "è·¨æµ·å¤§æ©‹èˆ‡åœ°æ¨™",
                summary: "é€²å…¥æ–¯å¥ˆå±±åŠå³¶ã€‚",
                tips: [
                    { type: "drone", text: "è·¨æµ·å¤§æ©‹ç·šæ¢æ„Ÿå¿…æ‹ ğŸšã€‚" }
                ],
                locations: [
                    { name: "Hvammstangi (Start)", mapName: "Hvammstangi", coords: [65.3973, -20.9400], type: "start", desc: "å‰å¾€æ–¯å¥ˆå±±åŠå³¶", icon: "fa-car" },
                    { name: "KolgrafarfjÃ¶rÃ°ur", mapName: "KolgrafarfjÃ¶rÃ°ur", coords: [64.9663, -23.1362], type: "sight", desc: "åˆ€åŠå½¢ç‹€è·¨æµ·å¤§æ©‹ã€‚", icon: "fa-bridge" },
                    { name: "Kirkjufell", mapName: "Kirkjufell", coords: [64.9417, -23.3069], type: "sight", desc: "æ•™å ‚å±± (æ¬ŠåŠ›éŠæˆ²å ´æ™¯)ã€‚", icon: "fa-mountain" },
                    { name: "GrundarfjÃ¶rÃ°ur", mapName: "GrundarfjÃ¶rÃ°ur", coords: [64.9242, -23.2608], type: "stay", desc: "ä½å®¿æ•™å ‚å±±è…³ä¸‹ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 13,
                date: "6/30",
                title: "é»‘æ•™å ‚èˆ‡å›ç¨‹",
                summary: "åŠå³¶å—å´èˆ‡è¿”å›é›·å…‹é›…ç¶­å…‹ã€‚",
                tips: [
                    { type: "drone", text: "é»‘æ•™å ‚å°æ¯”å¼·çƒˆï¼Œé©åˆç©ºæ‹ ğŸšã€‚" }
                ],
                locations: [
                    { name: "GrundarfjÃ¶rÃ°ur (Start)", mapName: "GrundarfjÃ¶rÃ°ur", coords: [64.9242, -23.2608], type: "start", desc: "ç’°åŠå³¶å—ä¸‹", icon: "fa-car" },
                    { name: "BÃºÃ°akirkja", mapName: "BÃºÃ°akirkja", coords: [64.8218, -23.3846], type: "sight", desc: "è‘—åçš„é»‘æ•™å ‚ã€‚", icon: "fa-church" },
                    { name: "Arnarstapi", mapName: "Arnarstapi", coords: [64.7662, -23.6214], type: "sight", desc: "æµ·è•æ´èˆ‡å·¨äººçŸ³åƒã€‚", icon: "fa-water" },
                    { name: "ReykjavÃ­k Accommodation", mapName: "ReykjavÃ­k", coords: [64.1466, -21.9426], type: "stay", desc: "è¿”å›é¦–éƒ½ã€‚", icon: "fa-bed" }
                ]
            },
            {
                day: 14,
                date: "7/01",
                title: "é›·å…‹é›…ç¶­å…‹æ·±åº¦éŠ",
                summary: "å¸‚å€æ¡è²·ã€æ•´ç†å½±ç‰‡ã€æ…¶åŠŸå¤§é¤ã€‚",
                tips: [
                    { type: "shopping", text: "66Â°North æ¡è²·ä¼´æ‰‹ç¦®ã€‚" },
                    { type: "food", text: "æ™šé¤ï¼šGrillmarkaÃ°urinn æ…¶åŠŸå®´ã€‚" }
                ],
                locations: [
                    { name: "ReykjavÃ­k City", mapName: "ReykjavÃ­k", coords: [64.1466, -21.9426], type: "sight", desc: "å…¨æ—¥å¸‚å€æ´»å‹•ã€‚", icon: "fa-city" },
                    { name: "GrillmarkaÃ°urinn", mapName: "GrillmarkaÃ°urinn", coords: [64.1475, -21.9392], type: "food", desc: "æ…¶åŠŸå¤§é¤ã€‚", icon: "fa-utensils" }
                ]
            },
            {
                day: 15,
                date: "7/02",
                title: "æœ€å¾Œæ¡è²·èˆ‡è³¦æ­¸",
                summary: "æ¿å¡Šæ©‹èˆ‡é‚„è»Šã€‚",
                tips: [
                    { type: "safety", text: "è¨˜å¾—é ç•™é‚„è»Šæª¢æŸ¥æ™‚é–“ã€‚" }
                ],
                locations: [
                    { name: "ReykjavÃ­k (Start)", mapName: "ReykjavÃ­k", coords: [64.1466, -21.9426], type: "start", desc: "å‰å¾€æ©Ÿå ´æ–¹å‘", icon: "fa-car" },
                    { name: "Bridge Between Continents", mapName: "Bridge Between Continents", coords: [63.8680, -22.6756], type: "sight", desc: "å…©å¤§æ¿å¡Šæ©‹ã€‚", icon: "fa-bridge" },
                    { name: "KeflavÃ­k Airport", mapName: "KeflavÃ­k International Airport", coords: [63.9868, -22.6280], type: "airport", desc: "17:15 èµ·é£›ã€‚", icon: "fa-plane-departure" }
                ]
            }
        ];
    </script>

    <div id="app-container">
        <!-- LIST CONTAINER -->
        <div id="list-container" class="bg-white overflow-y-auto scroller relative">
            
            <!-- Sticky Header -->
            <div class="sticky top-0 z-40 bg-white/95 backdrop-blur-sm border-b border-gray-100 shadow-sm px-4 py-3">
                <h1 class="text-xl font-bold text-nordic-dark">ğŸ‡®ğŸ‡¸ å†°å³¶ 15 å¤©ç’°å³¶</h1>
                <div class="flex space-x-2 overflow-x-auto mt-2 pb-1 no-scrollbar" id="day-nav">
                    <!-- Day buttons injected by JS -->
                </div>
            </div>

            <div id="itinerary-content" class="p-4 pb-20 space-y-12">
                <!-- Content injected by JS -->
            </div>
        </div>

        <!-- MAP CONTAINER -->
        <div id="map-container" class="bg-gray-200">
            <div id="map" class="h-full w-full"></div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        // ---------------------------------------------------------
        // APP LOGIC
        // ---------------------------------------------------------

        // 1. Initialize Map
        const map = L.map('map', {
            zoomControl: false 
        }).setView([64.9631, -19.0208], 6); // Iceland center

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        L.control.zoom({ position: 'bottomright' }).addTo(map);

        let currentLayerGroup = L.layerGroup().addTo(map);
        let activeMarker = null;
        let currentDayIndex = -1; // Track current day to prevent redundant updates

        // 2. Render Functions
        const contentDiv = document.getElementById('itinerary-content');
        const navDiv = document.getElementById('day-nav');

        function renderApp() {
            travelData.forEach((dayData, index) => {
                // A. Render Navigation Buttons
                const navBtn = document.createElement('button');
                navBtn.className = `flex-shrink-0 px-3 py-1 text-sm rounded-full border border-gray-200 hover:bg-nordic-blue hover:text-white transition-colors day-btn`;
                navBtn.textContent = `D${dayData.day}`;
                navBtn.onclick = () => {
                    document.getElementById(`day-${dayData.day}`).scrollIntoView({ behavior: 'smooth' });
                };
                navDiv.appendChild(navBtn);

                // B. Render Itinerary Content
                const daySection = document.createElement('div');
                daySection.id = `day-${dayData.day}`;
                daySection.className = "day-section scroll-mt-28";
                daySection.dataset.index = index; // For Intersection Observer

                // Header
                let headerHtml = `
                    <div class="mb-6">
                        <span class="inline-block px-2 py-1 bg-nordic-blue text-white text-xs font-bold rounded uppercase tracking-wider mb-1">Day ${dayData.day} Â· ${dayData.date}</span>
                        <h2 class="text-2xl font-bold text-gray-800">${dayData.title}</h2>
                        <p class="text-gray-500 text-sm mt-1">${dayData.summary}</p>
                    </div>
                `;

                // Tips Section
                let tipsHtml = '';
                if(dayData.tips && dayData.tips.length > 0) {
                    tipsHtml = `<div class="bg-orange-50 border-l-4 border-orange-400 p-3 mb-6 rounded-r-lg text-sm text-orange-800 space-y-1">`;
                    dayData.tips.forEach(tip => {
                        let icon = tip.type === 'drone' ? 'fa-helicopter' : 
                                   tip.type === 'shopping' ? 'fa-cart-shopping' : 
                                   tip.type === 'food' ? 'fa-utensils' : 'fa-circle-info';
                        tipsHtml += `<div class="flex items-start gap-2"><i class="fa-solid ${icon} mt-1"></i><span>${tip.text}</span></div>`;
                    });
                    tipsHtml += `</div>`;
                }

                // Locations List
                let locationsHtml = '<div class="space-y-0">';
                
                dayData.locations.forEach((loc, locIndex) => {
                    // Transportation Card (if not first item)
                    if (locIndex > 0) {
                        locationsHtml += `
                            <div class="flex items-center transport-line pl-6 opacity-60">
                                <div class="bg-gray-100 px-3 py-1 rounded-full text-xs text-gray-500 flex items-center gap-2">
                                    <i class="fa-solid fa-route"></i> ç§»å‹•
                                </div>
                            </div>
                        `;
                    }

                    // Location Card
                    locationsHtml += `
                        <div class="location-card relative group bg-white border border-gray-100 hover:border-nordic-blue/50 rounded-xl p-4 shadow-sm hover:shadow-md transition-all cursor-pointer"
                             data-lat="${loc.coords[0]}" data-lng="${loc.coords[1]}" data-day="${index}">
                            <div class="flex items-start gap-4">
                                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-nordic-light flex items-center justify-center text-nordic-blue group-hover:bg-nordic-blue group-hover:text-white transition-colors">
                                    <i class="fa-solid ${loc.icon}"></i>
                                </div>
                                <div class="flex-grow">
                                    <h3 class="font-bold text-gray-800">${loc.name}</h3>
                                    <p class="text-sm text-gray-500 mt-1">${loc.desc}</p>
                                    <div class="mt-3">
                                        <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(loc.mapName)}" target="_blank" 
                                           class="inline-flex items-center gap-1 text-xs text-nordic-blue hover:underline bg-blue-50 px-2 py-1 rounded"
                                           onclick="event.stopPropagation()">
                                            <i class="fa-brands fa-google"></i> View on Map
                                        </a>
                                        ${loc.type === 'shopping' ? '<span class="ml-2 inline-flex items-center gap-1 text-xs text-green-600 bg-green-50 px-2 py-1 rounded">è£œçµ¦ç«™</span>' : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                locationsHtml += '</div>';

                daySection.innerHTML = headerHtml + tipsHtml + locationsHtml;
                contentDiv.appendChild(daySection);
            });
        }

        renderApp();

        // 3. Map Update Logic
        function updateMap(dayIndex) {
            // Prevent redundant updates
            if (currentDayIndex === dayIndex) return;
            currentDayIndex = dayIndex;

            currentLayerGroup.clearLayers();
            const data = travelData[dayIndex];
            const latlngs = [];

            data.locations.forEach((loc, i) => {
                // Custom Marker: Circle with Icon (Updated Style)
                const iconHtml = `
                    <div class="custom-marker-circle">
                        <i class="fa-solid ${loc.icon}"></i>
                    </div>
                `;
                
                const icon = L.divIcon({
                    className: 'custom-div-icon', // Keep base class
                    html: iconHtml,
                    iconSize: [36, 36],    // Width, Height matches CSS
                    iconAnchor: [18, 18]   // Center point (half of size) to be accurate on coords
                });

                const marker = L.marker(loc.coords, { icon: icon }).addTo(currentLayerGroup);
                marker.bindPopup(`<b>${loc.name}</b><br>${loc.desc}`);
                
                // Link marker to DOM element for hover effect
                marker._id = `${dayIndex}-${i}`;
                latlngs.push(loc.coords);
            });

            // Draw Route
            if (latlngs.length > 1) {
                L.polyline(latlngs, { color: '#4A6FA5', weight: 4, opacity: 0.7, dashArray: '10, 10' }).addTo(currentLayerGroup);
            }

            // Fly to bounds
            if (latlngs.length > 0) {
                const bounds = L.latLngBounds(latlngs);
                map.flyToBounds(bounds, { padding: [50, 50], maxZoom: 13, duration: 1.5 });
            }

            // Update Nav Button State
            document.querySelectorAll('.day-btn').forEach((btn, idx) => {
                if (idx === parseInt(dayIndex)) {
                    btn.classList.add('bg-nordic-dark', 'text-white', 'border-nordic-dark');
                } else {
                    btn.classList.remove('bg-nordic-dark', 'text-white', 'border-nordic-dark');
                }
            });
        }

        // 4. Interactions
        
        // A. Intersection Observer for Scroll (Revised for Mobile)
        // RootMargin explanation: 
        // '-10% 0px -70% 0px' creates a narrow "active" band near the top of the container.
        // It triggers when an element enters the area between 10% and 30% from the top.
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const dayIndex = entry.target.dataset.index;
                    updateMap(dayIndex);
                }
            });
        }, {
            root: document.getElementById('list-container'),
            rootMargin: '-10% 0px -70% 0px', // Focus on top area of viewport
            threshold: 0 // Trigger as soon as one pixel enters the margin
        });

        document.querySelectorAll('.day-section').forEach(section => {
            observer.observe(section);
        });

        // B. Hover/Click on List Items
        document.querySelectorAll('.location-card').forEach(card => {
            const handleInteract = () => {
                const lat = parseFloat(card.dataset.lat);
                const lng = parseFloat(card.dataset.lng);
                
                // Highlight marker on map
                currentLayerGroup.eachLayer(layer => {
                    const elem = layer.getElement();
                    if (elem) {
                        const mLat = layer.getLatLng().lat;
                        const mLng = layer.getLatLng().lng;
                        
                        // Compare floats with epsilon
                        if (Math.abs(mLat - lat) < 0.0001 && Math.abs(mLng - lng) < 0.0001) {
                            elem.classList.add('marker-active');
                            layer.setZIndexOffset(1000); // Bring to front
                        } else {
                            elem.classList.remove('marker-active');
                            layer.setZIndexOffset(0);
                        }
                    }
                });
            };

            card.addEventListener('mouseenter', handleInteract);
            card.addEventListener('click', () => {
                handleInteract();
                map.flyTo([card.dataset.lat, card.dataset.lng], 14); // Zoom to location
            });
        });

        // Initial Load
        updateMap(0);

    </script>
</body>
</html>
